#summary Solution for solving selenium upload file problem

= Проблема =

Досить поширеною проблемою для початківців, які починають працювати з Selenium є організація обробки завантаження файлу на сервер. Уся складність цього завдання полягає в тому, що потрібно обійти обмеження безпеки браузера. 

В основі Selenium ([http://code.google.com/p/iudico/wiki/AutomatedTests тут] детальніше) лежить Selenium Core, маніпуляції над браузером Selenium Core виконує за допомогою JS команд. У елемента управління "File upload" не можна змінювати значення атрибута "value" (він закритий для запису). Це стандартне обмеження для більшості браузерів, яке блокує можливість автоматичного завантаження на сервер довільних файлів (теоретично шкідливих).

Елемент "File upload", як правило, представляє собою текстове поле, не доступне для редагування, і кнопку, що викликає діалог вибору файлу. Приклад класичного елемента управління "File upload":


Ми вже з'ясували, що ввести в текстове поле необхідний шлях до файлу не вийде. Як знайти вихід з даної ситуації? Одним з варіантів вирішення даної проблеми є використання стандартної команди Selenium AttachFile, синтаксис - void AttachFile(string fieldLocator, string fileLocator). Проте, AttachFile не завжди допомагає, так, в ІЕ дана команда взагалі не працює. Приклад використання: 

{{{
selenium.Click("css=a[href='/Course/Import']");
selenium.WaitForPageToLoad(LoadTime);
selenium.AttachFile("name=fileUpload", courseUri);
selenium.Click("css=input[id='Import']");
selenium.WaitForPageToLoad(LoadTime);
}}}

= Вирішення =

 # Завантажте найновішу версію 7-zip на комп'ютер.
 # Відкрийте jar-файл Selenium RC Server (selenium-server-standalone-X.XX.X) за допомогою 7-zip.
 # Видаліть файл ліцензції LICENSE.
 # Перейдіть до core\scripts в межах jar-файлу.
 # Відредагуйте файл atoms.js.  (Клік правою клавішою мишки та  Редагувати, або клік та F4.)
 # Знайдіть рядок "a.value = d" і замініть його на "XPCNativeWrapper(a).value = d;"
 # Збережіть зміни.  Ось і все!

[http://code.google.com/p/selenium/issues/detail?id=2826#c14 Джерело]